var infos_LVLNLB="<p class='jn c1' id='infos_LV' style='display:none;'>Les numéros et préfixes figurant dans cette <b>liste VIP</B> sont <b>autorisés à vous joindre en toutes circonstances</b>. Quels que soient les réglages de l'appareil, aucun appel de ces numéros ne sera rejeté. A noter cependant que l'ajout en liste VIP du numéro d'un tiers appelant de manière anonyme n'aura aucun effet puisque l'appel reste fondamentalement anonyme.</p><p class='jn c1' id='infos_LN' style='display:none;'>Les numéros et préfixes figurant dans cette <b>liste Noire</B> sont automatiquement <b>rejetés</b> par l'appareil.<br/>L'ajout de numéros à la liste noire peut se faire soit par la présente interface, soit par le bouton de l'appareil. Pour mettre un préfixe en liste noire, saisissez-le en rajoutant une étoile pour chaque chiffre variable. Par exemple, pour bloquer tous les numéros à 10 chiffres commençant par 01.40[...], saisissez \"0140******\".</p><p class='jn c1' id='infos_LB' style='display:none;'>Les numéros et préfixes figurant dans cette <b>liste Blanche</B> sont les <b>seuls autorisés</b> à vous joindre. Tout numéro essayant de vous joindre mais ne faisant pas partie de cette liste sera automatiquement rejeté. Pour mettre un préfixe en liste blanche, saisissez-le en rajoutant une étoile pour chaque chiffre variable. Par exemple, pour autoriser tous les numéros à 10 chiffres commençant par 01.40[...], saisissez \"0140******\".</p>";var infos_mode="<p class='jn pInfo' id='infos_mode'><i>L'appareil peut être utilisé au choix dans l'un des 2 modes suivants :</i><br/><br/><b>- Mode Liste Noire</b>: dans ce mode, l'appareil laisse passer normalement tous les appels, sauf ceux que vous aurez choisi de bloquer. Ce mode présente la possibilité de bloquer les appels anonymes, les appels en provenance de l'étranger ou de numéros spéciaux, les appels nocturnes ainsi que 340 numéros de votre choix, que vous pourrez bannir soit par un appui sur le bouton de l'appareil après l'appel, soit en les saisissant depuis la présente interface. Ce mode permet également de bloquer des numéros par préfixes, c'est à dire bloquer tous les numéros commençant par une même série de chiffres.<br/>Enfin, vous pourrez définir une liste de <i>numéros \"VIP\"</i>, qui pourront vous appeler quelle que soit l'heure, le pays et même s'ils appartiennent à un préfixe normalement bloqué.<br/><br/><b>- Mode Liste Blanche</b> : à l'opposé du mode précédent, dans le mode \"Liste Blanche\" l'appareil bloque tous les appels entrants sauf ceux provenant d'une liste de numéros que vous aurez autorisés via la présente interface. Il est possible d'autoriser également tous les appels provenant de mobiles ou de zones géographiques voulues en mettant en liste blanche les préfixes correspondants.</p>";var infAppAno='<p class=\'jn pInfo\' id=\'infAppAno\'>Lorsque ce paramètre est réglé sur <i>Rejeter</i> ou <i>Vérifier</i>, l\'appareil bloquera ou vérifiera l\'ensemble des appels anonymes, c\'est à dire les appels présentés comme "MASQUE", "PRIVE", "SECRET", "INCONNU", "ANONYME", "APPEL EXTERNE", etc... sur l\'écran de votre téléphone.</p>';if(typeof pref_int_loc!=="undefined"){var infAppEtr="<p class='jn pInfo' id='infAppEtr'>Lorsque ce paramètre est réglé sur <i>Rejeter</i> ou <i>Vérifier</i>, l'appareil bloquera ou vérifiera tous les appels provenant de l'étranger ou de numéros non-nationnaux. En d'autres termes, seuls les numéros avec un nombre classique de chiffres ou présentant le préfixe international <i>00"+pref_int_loc+"</i> (réglable) pourront passer directement.<br/><i>Note: pour ne bloquer qu'un pays en particulier, bloquez-le par préfixe via la liste noire.</i></p>"}var infAppNoc="<p class='jn pInfo' id='infAppNoc'>Lorsque ce paramètre est réglé sur <i>Rejeter</i> ou <i>Vérifier</i>, l'appareil bloquera ou vérifiera tous les appels entrants pendant la plage horaire définie.</p>";var infAppPrefLN="<p class='jn pInfo' id='infAppPrefLN'>Indique le comportement que doit avoir l'appareil lors d'appels de numéros dont le préfixe est en liste noire :<br/>- <b>Rejeter</b> : pour rejeter directement l'appel<br/>- <b>Vérifier</b> : pour soumettre l'appelant à une vérification et décider ensuite si on le bloque ou pas.</p>";var infMethVerif="<p class='jn pInfo' id='infMethVerif'>Choisissez ici comment vérifier les appels dont le traitement est réglé à <i>Vérifier</i> :<br/><br/>- <b>Appui sur étoile</b> : demande à l'appelant d'appuyer sur '*' pour prouver qu'il n'est pas un robot ou démarcheur<br/><br/>- <b>Recopie d'un code aléatoire</b> : dicte un code à l'appelant et lui demande de le recopier pour prouver qu'il est humain<br/><br/>- <b>Saisie de la date de naissance</b> : demande à l'appelant de saisir votre date de naissance pour prouver qu'il vous connait. Les administrations ont généralement cette information.<br/><br/>- <b>Saisie de votre code postal</b> : demande à l'appelant de saisir votre code postal<br/><br/>- <b>Saisir un code d'accès</b> : l'appelant devra saisir un code que vous lui aurez préalablement communiqué pour vous joindre, à l'instar d'un digicode.<br/><br/> <i>Note: les centres d'appels ne peuvent généralement pas appuyer sur étoile ou saisir de code. N'importe laquelle de ces options devrait ainsi les éliminer.</i></p>";var infAppHorsLB="<p class='jn pInfo' id='infAppHorsLB'>Indique le comportement que doit avoir l'appareil lors d'appels de numéros ne figurant pas dans votre liste blanche :<br/>- <b>Rejeter</b> : pour rejeter directement l'appel<br/>- <b>Vérifier</b> : pour soumettre l'appelant à une vérification et décider ensuite si on le bloque ou pas.</p>";var infos_pInt="<p class='jn pInfo' id='infos_pInt'>Permet à l'appareil de savoir quels sont les numéros commençant par \"00\" ou par \"+\" à ne pas considérer comme étrangers.</p>";var infos_longn="<p class='jn pInfo' id='infos_longn'>Permet à l'appareil de savoir si un numéro doit être considéré comme normal ou spécial, d'après sa longueur.<br/>La valeur à saisir ici inclut le \"0\" au début du numéro.</p>";var infos_ethconfig="<p>Cette page permet de régler les paramètres réseau de votre CLIBASE V6.</p><p class='error'><b>ATTENTION:</b> La saisie de paramètres incorrects pourrait causer une perte de la connexion réseau du CLIBASE et donc empêcher l'accès à cette interface. Soyez donc très vigilants lorsque vous modifiez ces réglages. Utilisation réservée aux utilisateurs avertis.</p><br/>";var infClicTri="<span style='font-size:80%; color:grey;'> (cliquer sur le nom des colonnes pour trier)</span>";if(!(window.Uint8Array&&typeof window.Uint8Array==="function"&&typeof window.DOMParser==="function")){alert("Votre navigateur est obsolète et ne peut afficher l'interface du CLIBASE.\nMerci de le mettre à jour ou d'utiliser un autre navigateur.");window.location="clibase.png"}function gid(a){return document.getElementById(a)}function argURL(a){return unescape(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+escape(a).replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"))}function drapPaysDispo(a){switch(a){case"31":case"32":case"33":case"41":case"49":return true;default:return false}}function formNumTelPrAff(b,a){var c="";if((b=="32")||(b=="33")||(b=="41")||(b=="49")){c="0"}else{c="+"+b+"(0)"}for(j=0;j<12;j++){if(a[j]=="A"){c+="*"}else{if(a[j]!="F"){c+=a[j]}}}return c}function heureHHMMdeDate(a){return(a.getHours()<10?"0":"")+a.getHours()+":"+(a.getMinutes()<10?"0":"")+a.getMinutes()}function dateFormLocAA(b){var c="";var a;a=b.getDate();if(a<10){c+="0"}c+=a+"/";a=b.getMonth()+1;if(a<10){c+="0"}c+=a+"/";a=b.getFullYear().toString();c+=a.substr(2,2);return c}function StringtoXML(b){var c=new DOMParser();var a=c.parseFromString(b,"text/xml");return a}function ech_lignes_tab(f,b,a){var g=gid(f);var h=g.rows[b].cloneNode(true);var c=g.rows[a].cloneNode(true);g.rows[b].parentNode.replaceChild(c,g.rows[b]);g.rows[a].parentNode.replaceChild(h,g.rows[a])}function nl_minmax(h,g,k,f){var c=gid(h);var b=k;var m=c.rows[b].cells[g].getAttribute("valtri");for(var a=k;a<c.rows.length;a++){var l=c.rows[a].cells[g].getAttribute("valtri");var n=parseInt(l);if(!isNaN(n)){l=n}if(((f=="«")&&(l<m))||((f=="»")&&(l>m))){b=a;m=l}}return b}function tri_tab(l,k){var f=gid(l);var g=f.rows[0];var m="«";var n=g.cells[k].innerHTML.substr(0,1);if(n=="«"){m="»"}for(var h=0;h<g.cells.length;h++){var b=g.cells[h].innerHTML.substr(0,1);if((b=="«")||(b=="»")){g.cells[h].innerHTML=g.cells[h].innerHTML.substr(1)}}g.cells[k].innerHTML=m+g.cells[k].innerHTML;var c;for(var a=1;a<f.rows.length;a++){c=nl_minmax(l,k,a,m);if(c!=a){ech_lignes_tab(l,a,c)}}}function customAlert(k,b,g,f,a,h){var c=false;d=document;if(d.getElementById("modalContainer")){return}mObj=d.getElementsByTagName("body")[0].appendChild(d.createElement("div"));mObj.id="modalContainer";mObj.style.height=d.documentElement.scrollHeight+"px";alertObj=mObj.appendChild(d.createElement("div"));alertObj.id="alertBox";if(d.all&&!window.opera){alertObj.style.top=document.documentElement.scrollTop+"px"}alertObj.style.left=(d.documentElement.scrollWidth-alertObj.offsetWidth)/2+"px";alertObj.style.visiblity="visible";h1=alertObj.appendChild(d.createElement("h1"));h1.style.backgroundColor=a;h1.appendChild(d.createTextNode(k));msg=alertObj.appendChild(d.createElement("p"));msg.innerHTML=b;for(i=0;i<g.length;i++){btn=alertObj.appendChild(d.createElement("a"));btn.id="closeBtn";btn.style.backgroundColor=a;btn.appendChild(d.createTextNode(g[i]));btn.href="#";btn.focus();btn.setAttribute("onclick","this.style.background='grey'; "+f[i])}alertObj.style.display="block";if(h){setTimeout(function(){removeCustomAlert()},h)}}function removeCustomAlert(){try{document.getElementsByTagName("body")[0].removeChild(gid("modalContainer"))}catch(a){}}function rechListe(c){var h=rawdata_list.indexOf(c),a="",g="";if(h!=-1){g=String.fromCharCode(parseInt(rawdata_list.substr(h-2,2),16));var b=rawdata_list.substr(h+16,30);for(var f=0;f<b.length;f+=2){car=b.substr(f,2);if(car=="FF"){break}car=String.fromCharCode(parseInt(car,16));if(car!="\0"){a+=car}else{break}}}return[g,utf8_decode(a)]}function remplir_journal(){getUrlFileAsBin("/eeprom_dump.bin?dat=L",remplir_journal_AJAX0)}function remplir_journal_AJAX0(b){var a;rawdata_list="";for(var c=0;c<b.length;c++){a=b[c].toString(16).toUpperCase();if(a.length<2){a="0"+a}rawdata_list+=a}getUrlFileAsBin("/eeprom_dump.bin?dat=J",remplir_journal_AJAX)}function remplir_journal_AJAX(z){var x;var r;var c=gid("tab_jl");var t=argURL("num");var b=gid("titre");b.innerHTML="Journal d'appels";if(t!=""){b.innerHTML+=" du "+t}for(var F=0;(F+34)<z.length;F+=34){if(z[F]!=255){var n=(z[F+1]*16777216)+(z[F+2]*65536)+(z[F+3]*256)+z[F+4]+946684800-3600;var J=new Date(1000*n);var M=parseInt(z[F+5]).toString(16).toUpperCase();if(M.length<2){M="0"+M}var A="";var h="";for(j=6;j<8;j++){x=z[F+j].toString(16).toUpperCase();if(x.length<2){x="0"+x}h+=x}for(j=0;j<4;j++){if(h[j]!="F"){A+=h[j]}}var G="";for(j=8;j<14;j++){x=z[F+j].toString(16).toUpperCase();if(x.length<2){x="0"+x}G+=x}var y="";if(M!="00"){y="Anonyme ("+M+")"}else{y=formNumTelPrAff(A,G);if(y==""){y="Inconnu";M="ZZ"}}if(t==""||y==t){var B=String.fromCharCode(z[F]);var L=(B=="E")?"«":"»";var s=h+G;var I=rechListe(s);var w=I[0];var u="";for(j=14;j<29;j++){x=String.fromCharCode(z[F+j]);if(x!="\0"){u+=x}else{break}}u=utf8_decode(u);var D,E="",C;var H=z[F+29].toString(16).toUpperCase();if(H.length<2){H="0"+x}switch(H.substr(0,1)){case"2":D="Autorisé ";C="limegreen";break;case"9":D="Rejeté ";C="red";break}switch(H){case"21":E="Liste Blanche";break;case"22":E=" <img src='etoile.png' title='VIP' style='height:15px;'/> Liste VIP";break;case"23":E="N°Etranger/Spécial, auth. OK";break;case"24":E="Anonyme, auth. OK";break;case"25":E="Appel Nocturne, auth. OK";break;case"26":E="Hors Liste Blanche, auth. OK";break;case"27":E="Préfixe Liste Noire, auth. OK";break;case"90":E="N°Etranger/Spécial";break;case"91":E="N°Etranger/Spécial, échec auth.";break;case"92":E="Anonyme";break;case"93":E="Anonyme, échec auth.";break;case"94":E="Appel Nocturne";break;case"95":E="Appel Nocturne, échec auth.";break;case"96":E="Hors Liste Blanche";break;case"97":E="Hors Liste Blanche, échec auth.";break;case"98":E="Liste Noire";break;case"99":E="Préfixe Liste Noire";break;case"9A":E="Préfixe Liste Noire, échec auth.";break;case"9B":E="Exception Liste Blanche";break;case"9F":E="Pb. données";break}switch(A){case"352":img_pref="31";break;case"262":case"590":case"594":case"596":case"687":img_pref="33";break;default:img_pref=A}if(M=="00"){if(w==""){var q=motTypeListe.substr(0,1);var K="<a href='#' title='Mettre en liste "+motTypeListe+"' onclick=\"  customAlert('Mettre en liste "+motTypeListe+"', 'Etes-vous sûr(e) de vouloir mettre &lt;"+y+"&gt;";if(u!=""){K+=" ("+u.replace(/['"]/g," ")+")"}K+=" en Liste "+motTypeListe+" ?', ['Annuler','Oui'], ['removeCustomAlert();','window.location.replace(\\'listes.htm?tl="+q+"&act=A&type="+q+"&num=00"+A+G.replace(/[F]/g,"")+"&nom="+u+"\\');'], 'orange', 0);\">x</a>"}else{K="<span title='Déjà dans liste'>-</span>"}}else{K="<span title='Anonyme'>-</span>"}var g=c.insertRow(-1);g.style.height="28px";var p=g.insertCell(-1);p.setAttribute("valtri",B);p.innerHTML="<img src='tel.png'/> <div class='symDirAppel'>"+L+"</div>";var o=g.insertCell(-1);o.setAttribute("valtri",n.toString());o.innerHTML=dateFormLocAA(J)+" "+heureHHMMdeDate(J);var m=g.insertCell(-1);if(y=="Inconnu"){r="0"}else{if(y.indexOf("Anonyme")!=-1){r="1"}else{r=A+y}}m.setAttribute("valtri",r);m.style.whiteSpace="nowrap";if(drapPaysDispo(img_pref)){m.innerHTML+="<img src='drap_pref/_%2bimg_pref%2b_.html' class='minidrap' title='"+A+"' alt='"+A+"' style='margin-right:4px;'/>"}m.innerHTML+="<a href='fonctions9014.html?num=%22+y+%22'>"+y+"</a>";var l=g.insertCell(-1);l.setAttribute("valtri",u.toUpperCase());l.innerHTML=u;var k=g.insertCell(-1);k.setAttribute("valtri","0x"+H);k.style.textAlign="right";div=document.createElement("div");div.style.backgroundColor=C;div.className="rdIa";k.appendChild(div);var f=g.insertCell(-1);f.setAttribute("valtri",H);f.style.textAlign="left";f.appendChild(document.createTextNode(D));if(E!=""){span=document.createElement("div");span.innerHTML=E;span.className="iat2";f.appendChild(span)}var a=g.insertCell(-1);a.setAttribute("valtri",K);a.style.cursor="help";a.innerHTML=K}}}tri_tab("tab_jl",1);tri_tab("tab_jl",1)}function gest_btns_menu(){gid("menu_btn_LN").style.display=dispSiLN;gid("menu_btn_LV").style.display=dispSiLN;gid("menu_btn_LB").style.display=dispSiLB;gid("menu_btn_LE").style.display=dispSiLB}function getUrlFileAsBin(b,a){var c=new XMLHttpRequest();c.open("GET",b,true);c.responseType="arraybuffer";c.onload=function(g){removeCustomAlert();var f=new Uint8Array(c.response);a(f)};customAlert("Chargement","Merci de patienter...",[],[],"DarkSlateBlue",0);setTimeout(function(){c.send()},500)}function gerer_cadenas_form_aj(){var a=gid("cadenas_form_aj");document.getElementsByName("type")[0].value=a.checked?"n":"N"}function verif_num(){var a=gid("num");for(var b=0;b<a.value.length;b++){var f=a.value.charAt(b);if(!(((f>="0")&&(f<="9"))||((b==0)&&(f=="+"))||(f=="*"))){a.value=a.value.substr(0,b)+a.value.substr(b+1);b--}}}var f1Ok=false;function f1Submit(){var a=gid("num").value.length;if(((a<lgnmin.valueOf())||(a>lgnmax.valueOf()))&&!f1Ok){customAlert("Longueur du numéro","La longueur du numéro/préfixe saisi ne correspond pas à la longueur habituelle des numéros de téléphone de votre pays.<br/>A moins que vous ne souhaitiez lister un numéro spécial ou étranger, votre saisie est donc potentiellement incorrecte.",["Corriger","Poursuivre"],["removeCustomAlert();","f1Ok=true; gid('f1').submit();"],"Orange",0);return false}return true}function aff_listes(){getUrlFileAsBin("/eeprom_dump.bin?dat=L",aff_listes_AJAX)}function aff_listes_AJAX(t){ltrTypeListe=argURL("tl");gid("i1").value=ltrTypeListe;gid("i2").value=ltrTypeListe;if(ltrTypeListe=="V"){aff_id("etl")}gid("i0").innerHTML="Ajouter un numéro à la Liste "+motTypeListe+" :";if(result_act!=""){var y="Action inconnue";var w="orange";var A="?";switch(result_act.charAt(0)){case"A":A="Ajout d'un numéro";switch(result_act.substr(1)){case"10":w="OrangeRed";y="Une erreur est survenue lors de la tentative d'ajout du numéro. Réessayez.";break;case"11":w="LimeGreen";y="Numéro ajouté avec succès !";break;case"99":w="OrangeRed";y="Le numéro ne peut être ajouté : mémoire pleine";break;case"98":w="Orange";y="Opération impossible : ce numéro est déjà présent en mémoire";break;default:w="Red";y="ERR_RESULT_ACT_A:"+result_act.substr(1);break}break;case"S":A="Suppression d'un numéro";switch(result_act.substr(1)){case"10":w="OrangeRed";y="Une erreur est survenue lors de la tentative de retrait du numéro. Réessayez.";break;case"11":w="LimeGreen";y="Numéro retiré avec succès !";break;case"97":w="Orange";y="Opération impossible : ce numéro n'est pas présent en mémoire";break;default:w="Red";y="ERR_RESULT_ACT_S:"+result_act.substr(1);break}break}customAlert(A,y+"<br/>&nbsp;",[],[],w,2750)}var s,C,B;var z=gid("tab_ln");for(C=0;C<t.length;C+=35){if(t[C]!=255){var G=String.fromCharCode(t[C]);var u="";var h="";for(B=1;B<3;B++){s=t[C+B].toString(16).toUpperCase();if(s.length<2){s="0"+s}h+=s}for(B=0;B<4;B++){if(h[B]!="F"){u+=h[B]}}var E="";for(B=3;B<9;B++){s=t[C+B].toString(16).toUpperCase();if(s.length<2){s="0"+s}E+=s}num_tel=formNumTelPrAff(u,E);var r="";for(B=9;B<24;B++){s=String.fromCharCode(t[C+B]);if(s!="\0"){r+=s}else{break}}r=utf8_decode(r);var g=(t[C+24]*16777216)+(t[C+25]*65536)+(t[C+26]*256)+t[C+27]+946684800-3600;var x=new Date(1000*g);var m=(t[C+28]*16777216)+(t[C+29]*65536)+(t[C+30]*256)+t[C+31]+946684800-3600;var f=new Date(1000*m);var D=parseInt(t[C+32]);if(G.toUpperCase()==ltrTypeListe){switch(u){case"352":img_pref="31";break;case"262":case"590":case"594":case"596":case"687":img_pref="33";break;default:img_pref=u}var c=z.insertRow(-1);var q=c.insertCell(-1);q.setAttribute("valtri",u);if(drapPaysDispo(img_pref)){q.innerHTML="<img src='drap_pref/_%2bimg_pref%2b_.html' class='minidrap' title='"+u+"' alt='"+u+"'/>"}else{q.innerText=u;q.style.color="grey";q.style.fontSize="80%"}var p=c.insertCell(-1);p.setAttribute("valtri",num_tel.split("*").join("0"));p.innerHTML="<a href='journalfe6e.html?num=%22+num_tel+%22'>"+num_tel+"</a>";var o=c.insertCell(-1);o.setAttribute("valtri",r.toUpperCase());o.innerHTML=r;var n=c.insertCell(-1);n.setAttribute("valtri",g.toString());n.innerHTML=dateFormLocAA(x)+" "+heureHHMMdeDate(x);var l=c.insertCell(-1);l.setAttribute("valtri",m.toString());l.innerHTML=dateFormLocAA(f)+" "+heureHHMMdeDate(f);var k=c.insertCell(-1);k.setAttribute("valtri",D.toString());k.innerHTML=D.toString();var b=c.insertCell(-1);if(G=="n"){b.setAttribute("valtri","cad");b.innerHTML="<img src='cadenas.png' title='Ne peut être effacé lors du rebouclage mémoire' style='cursor:help;'/>"}else{if(G=="V"){b.innerHTML="<img src='etoile.png' title='VIP' style='height:15px;'/>"}else{b.setAttribute("valtri","")}}var a=c.insertCell(-1);var F="<a href='#' title='Supprimer ce numéro' onclick=\"  customAlert('Supprimer un numéro', 'Etes-vous sûr(e) de vouloir supprimer &lt;"+num_tel+"&gt;";if(r!=""){F+=" ("+r.replace(/['"]/g,"`")+")"}F+=" de la liste "+motTypeListe.replace(/['"]/g,"`")+" ?', ['Annuler','Oui'], ['removeCustomAlert();','window.location.replace(\\'?tl="+ltrTypeListe+"&act=S&pref="+h+"&num="+E+"\\');'], 'orange', 0);\">x</a>";a.innerHTML=F}}}if(ltrTypeListe=="N"){gid("tdCadLN").style.display="table-cell"}aff_id("infos_L"+ltrTypeListe);tri_tab("tab_ln",3);tri_tab("tab_ln",3);gid("num").focus()}function afficher_reglages(){if(result_act=="M"){customAlert("Réglages","Les modifications ont bien été prises en compte !<br/>&nbsp;",[],[],"LimeGreen",2750)}if(result_act=="E"){customAlert("Réglages","Erreur lors du paramétrage. Veuillez vérifier les valeurs saisies et réessayer.<br/>&nbsp;",["OK"],["removeCustomAlert();"],"OrangeRed",0)}maj_voys();gestAffHeures();gestAffModeListe();gestAffMethAuth();gest_affcache_premium()}function aff_id(a){gid(a).style.display="inline-block"}function masq_id(a){gid(a).style.display="none"}function aff_masq_id(a){if(gid(a).style.display=="inline-block"){masq_id(a)}else{aff_id(a)}}function gestAffHeures(){var b=gid("HeuresbNoc");var a=document.getElementsByName("bNoc")[0];var c;if(a.options[a.selectedIndex].value>="1"){c="block"}else{c="none"}b.style.display=c}function gestAffModeListe(){var g=document.getElementsByName("mLst")[0];var c=document.getElementsByClassName("LN");var f=document.getElementsByClassName("LB");var a,b;if(g.options[g.selectedIndex].value=="1"){a="table-row";b="none"}else{a="none";b="table-row"}for(i=0;i<c.length;i+=1){c[i].style.display=a}for(i=0;i<f.length;i+=1){f[i].style.display=b}gestAffMethAuth();gest_affcache_premium()}function gest_affcache_premium(){var g=document.getElementsByClassName("Premium");var c=["bAno","bEtr","bNoc","aPrefLN"];if(dispSiPremium=="none"){for(var b=0;b<c.length;b++){var f=document.getElementsByName(c[b])[0];for(var a=0;a<f.options.length;a++){if(f.options[a].value=="2"){f.remove(a)}}}for(b=0;b<g.length;b+=1){g[b].style.display="none"}}}function gestAffMethAuth(){var a=document.getElementsByName("mLst")[0];if(a.options[a.selectedIndex].value=="1"){var l=["bAno","bEtr","bNoc","aPrefLN"]}else{var l=["aHorsLB"]}var k=document.getElementsByClassName("meth_auth");var g=false;for(var f=0;f<l.length;f++){var b=document.getElementsByName(l[f])[0];if(b.options[b.selectedIndex].value=="2"){g=true}}if(g){var h="table-row"}else{var h="none"}for(f=0;f<k.length;f+=1){k[f].style.display=h}var c=document.getElementsByName("mAuth")[0];if(parseInt(c.options[c.selectedIndex].value)>=2){h="block"}else{h="none"}gid("div_codeAuth").style.display=h;if(c.options[c.selectedIndex].value=="2"){h="inline"}else{h="none"}gid("codeAuth2").style.display=h;if(c.options[c.selectedIndex].value=="3"){h=5}else{h=4}var m=document.getElementsByName("cAuth")[0];m.maxLength=h;m.value=m.value.substring(0,h)}function verif_codeAuth(a){for(var b=0;b<a.value.length;b++){var f=a.value.charAt(b);if(!(((f>="0")&&(f<="9"))||(f=="*")||(f=="#"))){a.value=a.value.substr(0,b)+a.value.substr(b+1);b--}}}function maj_voys(){var f=["bAno","bEtr","bNoc","aPrefLN","aHorsLB"];for(var b=0;b<f.length;b++){var c=document.getElementsByName(f[b])[0];var a=gid("voy_"+f[b]);if((v=c.options[c.selectedIndex].value)=="0"){a.style.backgroundColor="#0ebf0e"}else{if(v=="2"){a.style.backgroundColor="orange"}else{a.style.backgroundColor="#f50000"}}}gestAffMethAuth()}function clicLapr(){masq_id("lapr");gid("paramsreg").style.display="block"}function chg_pInt(){var a=document.getElementsByName("pInt")[0];var b=gid("img_pInt");b.src="drap_pref/"+a.value+".png"}form1SubOk=false;function form1Sub(){var a=document.getElementsByName("mLst")[0];if((a.options[a.selectedIndex].getAttribute("initial")!="selected")&&!form1SubOk){customAlert("Changement de mode","Vous êtes sur le point de changer de mode. Cette opération videra donc la liste Noire/Blanche/VIP actuelle au profit du nouveau mode.<br/><br/>Continuer ?",["Non","Oui"],["removeCustomAlert();","form1SubOk=true; gid('form1').submit();"],"Orange",0);return false}return true}function maj_champs_debug(c){if(!c){customAlert("Ooops !","Le CLIBASE ne répond pas...",[],[],"Orange",0);return}removeCustomAlert();var b="";var f=c.childNodes;for(var a=0;a<f.length;a++){b+="<b>"+f[a].attributes.intit.value+" :</b> "+f[a].childNodes[0].nodeValue+"<br/><br/>"}gid("infos_deb").innerHTML=b}var timeOutMS=5000;var ajaxList=new Array();function newAJAXCommand(c,a,h,g){var f=new Object();var b=new Date();f.url=c;f.container=a;f.repeat=h;f.ajaxReq=null;if(window.XMLHttpRequest){f.ajaxReq=new XMLHttpRequest();f.ajaxReq.open((g==null)?"GET":"POST",f.url,true);f.ajaxReq.send(g)}else{if(window.ActiveXObject){f.ajaxReq=new ActiveXObject("Microsoft.XMLHTTP");if(f.ajaxReq){f.ajaxReq.open((g==null)?"GET":"POST",f.url,true);f.ajaxReq.send(g)}}}f.lastCalled=b.getTime();ajaxList.push(f)}function pollAJAX(){var c=new Object();var b=new Date();var a;for(i=ajaxList.length;i>0;i--){c=ajaxList.shift();if(!c){continue}a=b.getTime()-c.lastCalled;if(c.ajaxReq.readyState==4&&c.ajaxReq.status==200){if(typeof(c.container)=="function"){c.container(c.ajaxReq.responseXML.documentElement)}else{if(typeof(c.container)=="string"){gid(c.container).innerHTML=c.ajaxReq.responseText}}c.ajaxReq.abort();c.ajaxReq=null;if(c.repeat){newAJAXCommand(c.url,c.container,c.repeat)}continue}if(a>timeOutMS){if(typeof(c.container)=="function"){c.container(null)}else{alert("Echec.\nLa connexion avec l'appareil a été perdue.")}c.ajaxReq.abort();c.ajaxReq=null;if(c.repeat){newAJAXCommand(c.url,c.container,c.repeat)}continue}ajaxList.push(c)}setTimeout("pollAJAX()",10)}function getXMLValue(a,c){try{if(a.getElementsByTagName(c)[0].firstChild.nodeValue){return a.getElementsByTagName(c)[0].firstChild.nodeValue}else{return null}}catch(b){return null}}function utf8_encode(a){return a}function utf8_decode(a){return a}setTimeout("pollAJAX()",500);function afficher_ethconfig(){configIPBoxes();switch(resConfEth){case"10":customAlert("Paramètres réseau","Les nouveaux paramètres réseau ont bien été enregistrés.<br/>L'appareil va redémarrer pour les prendre en compte. Cliquez ensuite <a href='index.html'>ici</a> pour retourner à la page d'accueil<br/><br/><i>Si l'adresse IP a été changée, il peut être nécessaire d'effectuer une commande [nbtstat -R] et de fermer/rouvrir le navigateur.</i>",[],[],"LimeGreen",0);setTimeout("newAJAXCommand('reboot.cgi',bid,false);",500);break;case"90":customAlert("Paramètres réseau","Les paramètres saisis sont incorrects et n'ont pu être pris en compte. Reessayez.",["OK"],["removeCustomAlert();"],"Red",0);break}}function configIPBoxes(){e=document.forms.config;st=e.dhcp.checked;e.ip.disabled=st;e.gw.disabled=st;e.sub.disabled=st;e.dns1.disabled=st;e.dns2.disabled=st}function bid(a){}function popupUpload(){customAlert("Téléchargement en cours","Cette opération peut durer quelques minutes.<br/><br/>Veuillez patienter...<br/>&nbsp;",[],[],"#3764dc",0)}function afficher_upload(){if(window.location.search.substr(1).indexOf("all")==0){gid("upall").style.display="block"}var c=gid("tabfich");var b=c.insertRow(-1);var f,k=null;for(var t=5;t>=1;t--){k=b.insertBefore(document.createElement("th"),k);switch(t){case 1:f="Son";break;case 2:f="Fichier actuel";break;case 3:f="Taille";break;case 4:f="Changement de fichier";break;case 5:f="Restaurer l'original";break}k.innerHTML=f}TAMSDxml=StringtoXML("<xml>"+TAMSDxml.replace(/&/g,"&amp;")+"</xml>");var u=TAMSDxml.childNodes[0].childNodes,m;for(var s=0;s<u.length;s++){b=c.insertRow(-1);for(var t=1;t<=5;t++){m=(t==1)?b.insertBefore(document.createElement("th"),null):b.insertCell(-1);var o=utf8_decode(u[s].attributes.fn.value);var h=o.substr(o.lastIndexOf("."));var q=u[s].attributes.i.value;switch(t){case 1:m.innerHTML=nommer_PEM(parseInt(u[s].attributes.i.value));break;case 2:m.innerHTML="<a href='fgen_%2bh%2b_884e.html?PEM=%22+q+%22'>"+o+"</a>";break;case 3:m.innerHTML=(Math.round(parseInt(u[s].attributes.t.value)/1024)).toString()+" Ko";break;case 4:var g=document.createElement("form");g.setAttribute("method","post");g.setAttribute("action","upload.htm");g.setAttribute("enctype","multipart/form-data");var l=document.createElement("input");l.setAttribute("type","hidden");l.setAttribute("name","PEMforce");l.setAttribute("value",u[s].attributes.i.value);var p=document.createElement("input");p.setAttribute("type","file");p.setAttribute("name","file");p.setAttribute("id","filePEM"+q);p.setAttribute("onChange","popupUpload(); submit();");p.style.display="none";var x=document.createElement("input");x.setAttribute("type","button");x.setAttribute("value","Parcourir...");x.setAttribute("onclick","gid('filePEM"+u[s].attributes.i.value+"').click();");g.appendChild(l);g.appendChild(p);g.appendChild(x);m.appendChild(g);break;case 5:var w=document.createElement("a");w.setAttribute("href","?restpem="+q);var n=document.createElement("input");n.setAttribute("type","button");n.setAttribute("value","¤");w.appendChild(n);m.appendChild(w);break}}}if(result_fileupload!=""){var r=(result_fileupload.indexOf("Err")==0)?"Red":"LimeGreen";customAlert("Transfert fichier",utf8_decode(result_fileupload)+"<br/>&nbsp;",[],[],r,4000)}}function nommer_PEM(a){switch(a){case 14:return'"Appel Anonyme - indésirable"';case 15:return'"Appel Nocturne - indésirable"';case 16:return'"Appel Etr./Spéc. - indésirable"';case 17:return'"Appelant en liste noire"';case 18:return'"Appelant hors liste blanche"';case 19:return'"Appel rejeté"';case 20:return'"Auth. app. étoile"';case 21:return'"Auth. recopie code aléa."';case 22:return'"Auth. saisie date naissance"';case 23:return'"Auth. saisie code postal"';case 24:return'"Auth. saisie code d\'accès"';case 25:return'"Identification OK"';case 26:return'"Identification échouée"';case 27:return'"Répondeur"';default:return("PEM"+a.toString())}};